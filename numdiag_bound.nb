(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     25530,        639]
NotebookOptionsPosition[     24837,        612]
NotebookOutlinePosition[     25198,        628]
CellTagsIndexPosition[     25155,        625]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"DEFINE", " ", "PARAMETERS"}], "*)"}]], "Input",
 CellChangeTimes->{{3.680340241887388*^9, 3.6803402464623203`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["m", "N"], "=", "940"}], ";", 
  RowBox[{"\[HBar]c", "=", "197.327"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"V0", "=", "150"}], ";", 
  RowBox[{"R", "=", "2"}], ";", 
  RowBox[{"a", "=", "0.2"}], ";", 
  RowBox[{"\[Mu]", "=", 
   RowBox[{
    FractionBox["8", "9"], " ", 
    SubscriptBox["m", "N"]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rmax", "=", "3"}], ";", 
  RowBox[{"dr", "=", "0.01"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rlist", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "rmax", ",", "dr"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"len", "=", 
   RowBox[{"Length", "[", "rlist", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "[", "r_", "]"}], ":=", 
   FractionBox[
    RowBox[{"-", "V0"}], 
    RowBox[{"1", "+", 
     RowBox[{"Exp", "[", 
      FractionBox[
       RowBox[{"r", "-", "R"}], "a"], "]"}]}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Vmat", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"V", "[", "rlist", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"V", "[", "rlist", "]"}], ",", 
   RowBox[{"DataRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "rmax"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.679286728059107*^9, 3.679286751534897*^9}, {
   3.679286798295683*^9, 3.679286809263542*^9}, {3.679287253510089*^9, 
   3.679287322870791*^9}, 3.679289429930531*^9, {3.679289796355823*^9, 
   3.679289797938469*^9}, {3.679291047782339*^9, 3.679291048165627*^9}, {
   3.679291140911874*^9, 3.679291141375329*^9}, {3.6793008229741793`*^9, 
   3.679300823061451*^9}, {3.679301164043964*^9, 3.679301164138753*^9}, 
   3.679301319405847*^9, {3.679301744500462*^9, 3.67930174459568*^9}, {
   3.6793070233533278`*^9, 3.679307024200685*^9}, {3.6793071120422153`*^9, 
   3.679307112865924*^9}, {3.6793080233437357`*^9, 3.679308046871706*^9}, {
   3.679634080442708*^9, 3.6796340987636414`*^9}, {3.679634333800329*^9, 
   3.6796343349092484`*^9}, {3.679639176058004*^9, 3.679639188049914*^9}, {
   3.679807334723302*^9, 3.6798073352989483`*^9}, {3.679810418572747*^9, 
   3.6798104194925003`*^9}, 3.679817313239819*^9, {3.67982481522514*^9, 
   3.679824826096957*^9}, 3.679824944379553*^9, {3.679825144782433*^9, 
   3.679825146037923*^9}, {3.6798251853752337`*^9, 3.679825198374642*^9}, {
   3.6798261250607224`*^9, 3.679826125748369*^9}, {3.679826734942071*^9, 
   3.6798267363656807`*^9}, 3.679826793054708*^9, {3.679827280758219*^9, 
   3.679827316430401*^9}, {3.6798274637769814`*^9, 3.679827467464611*^9}, {
   3.679827661452016*^9, 3.679827662939715*^9}, {3.680260876979437*^9, 
   3.680260889931306*^9}, {3.6803421387261133`*^9, 3.680342138836822*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011111111111111112`],
      AbsoluteThickness[1.6], LineBox[CompressedData["
1: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
tpXUSwY8hhA1u72+KiPqJf8Hurs9Pw==
      "]]}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0, 3.}, {-149.99319031969463`, 0}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.02]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.6790525019311647`*^9, 3.679052566523169*^9, 3.679196433941718*^9, {
   3.679197277655931*^9, 3.679197294275297*^9}, 3.679203964377475*^9, {
   3.679211502047686*^9, 3.679211535666667*^9}, 3.679211579918518*^9, 
   3.6792116311039762`*^9, 3.67921462355632*^9, 3.6792214221859913`*^9, {
   3.679283487206999*^9, 3.6792835073757553`*^9}, 3.6792846970975523`*^9, 
   3.6792868319626226`*^9, 3.679287023698317*^9, 3.6792873635378437`*^9, 
   3.679287540947575*^9, 3.679287851949174*^9, 3.6792894968350487`*^9, 
   3.679289801327577*^9, 3.67928988339225*^9, {3.679290586852947*^9, 
   3.6792906106198874`*^9}, 3.679291052837352*^9, 3.679291144824926*^9, 
   3.679300829791338*^9, 3.679301167845834*^9, 3.679301321689472*^9, 
   3.679301749581284*^9, {3.679301879491131*^9, 3.6793019059515667`*^9}, 
   3.679307028443761*^9, 3.679307118178897*^9, 3.679307330661931*^9, {
   3.679308027838118*^9, 3.6793080494175997`*^9}, 3.6793094652195168`*^9, 
   3.679312432920207*^9, 3.6793125177770147`*^9, 3.679628067813961*^9, {
   3.679634085969236*^9, 3.679634100282443*^9}, 3.679634336318362*^9, 
   3.679636276044846*^9, 3.679636365377068*^9, 3.679637324382835*^9, {
   3.679639179099791*^9, 3.6796391886563473`*^9}, 3.6796392420372267`*^9, 
   3.679639953216379*^9, 3.679645643238593*^9, 3.679655354505178*^9, 
   3.679657001419363*^9, 3.6798073366123333`*^9, 3.679810113849227*^9, 
   3.679810420396698*^9, 3.679817173602425*^9, 3.67981722445964*^9, 
   3.67981731396034*^9, {3.6798248163876333`*^9, 3.679824826451214*^9}, 
   3.679824944708712*^9, 3.679825085115292*^9, 3.679825146676875*^9, {
   3.6798251878256817`*^9, 3.679825198640245*^9}, 3.679826126089068*^9, 
   3.679826737332171*^9, 3.6798267970030813`*^9, 3.679826897804422*^9, {
   3.6798272817675133`*^9, 3.679827317385491*^9}, 3.679827467911983*^9, 
   3.67982766331116*^9, 3.679831481957348*^9, 3.6802608919077187`*^9, 
   3.680339913758307*^9, 3.680342141076088*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"CALCULATE", " ", "HAMILTONIAN", " ", "MATRIX"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"one", "[", 
      RowBox[{"n_", ",", "d_"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{
       RowBox[{"1", "+", 
        RowBox[{"0", 
         RowBox[{"Range", "[", 
          RowBox[{"n", "-", 
           RowBox[{"Abs", "[", "d", "]"}]}], "]"}]}]}], ",", "d"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"H0", "=", 
     RowBox[{"Vmat", "+", 
      RowBox[{
       FractionBox[
        RowBox[{"-", 
         SuperscriptBox["\[HBar]c", "2"]}], 
        RowBox[{"2", " ", "\[Mu]"}]], " ", 
       FractionBox["1", 
        SuperscriptBox["dr", "2"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"one", "[", 
          RowBox[{"len", ",", 
           RowBox[{"-", "1"}]}], "]"}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"one", "[", 
           RowBox[{"len", ",", "0"}], "]"}]}], "+", 
         RowBox[{"one", "[", 
          RowBox[{"len", ",", "1"}], "]"}]}], ")"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"k", "[", "En_", "]"}], ":=", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", "\[Mu]", " ", "En"}], 
        SuperscriptBox["\[HBar]c", "2"]]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"B", "[", "En_", "]"}], ":=", 
     RowBox[{"1", "-", 
      RowBox[{"dr", " ", 
       RowBox[{"k", "[", "En", "]"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Hnew", "[", "En_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"H", "=", "H0"}], ";", 
      RowBox[{
       RowBox[{"H", "[", 
        RowBox[{"[", 
         RowBox[{"len", ",", "len"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"Vmat", "[", 
         RowBox[{"[", 
          RowBox[{"len", ",", "len"}], "]"}], "]"}], "+", 
        RowBox[{
         FractionBox[
          RowBox[{"-", 
           SuperscriptBox["\[HBar]c", "2"]}], 
          RowBox[{"2", " ", "\[Mu]"}]], " ", 
         FractionBox["1", 
          SuperscriptBox["dr", "2"]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           RowBox[{"B", "[", "En", "]"}]}], ")"}]}]}]}], ";", "H"}], ")"}]}], 
   "\n", 
   RowBox[{
    RowBox[{"eigenv", "[", 
     RowBox[{"{", 
      RowBox[{"En_", ",", "i_"}], "}"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eval", ",", "evec"}], "}"}], "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Eigensystem", "[", 
            RowBox[{"Hnew", "[", "En", "]"}], "]"}], "]"}], ",", "First"}], 
         "]"}]}]}], ";", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eval", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "i"}], "}"}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.6790391017469873`*^9, {3.6790392440208473`*^9, 3.679039313462309*^9}, {
   3.679039353022828*^9, 3.6790393624544992`*^9}, {3.679039514753272*^9, 
   3.67903951659298*^9}, {3.679039723124398*^9, 3.67903975046845*^9}, {
   3.67921405591895*^9, 3.6792140664227943`*^9}, {3.6792146406725883`*^9, 
   3.679214647440013*^9}, {3.679286881961419*^9, 3.6792868921054163`*^9}, {
   3.679287380328823*^9, 3.6792873838310957`*^9}, {3.6792894539741707`*^9, 
   3.679289459285552*^9}, {3.6793094743259706`*^9, 3.6793094836301937`*^9}, {
   3.67963411316535*^9, 3.679634126807611*^9}, {3.679636756756248*^9, 
   3.6796367614119797`*^9}, {3.679637096065898*^9, 3.679637103161354*^9}, {
   3.6796372385233088`*^9, 3.67963724314743*^9}, {3.679807339891375*^9, 
   3.6798073552994413`*^9}, {3.679810170937397*^9, 3.679810174089325*^9}, {
   3.679817648629161*^9, 3.679817660253252*^9}, {3.680261003798294*^9, 
   3.680261056214637*^9}, {3.680340250552248*^9, 3.680340328885063*^9}, 
   3.6803410314839163`*^9, {3.680341148773532*^9, 3.680341150493453*^9}, {
   3.680341191086194*^9, 3.680341194542293*^9}, {3.680341322040676*^9, 
   3.680341348936768*^9}, {3.6803415482924843`*^9, 3.680341550372074*^9}, {
   3.6803415928052187`*^9, 3.680341594916544*^9}, {3.6803417095588493`*^9, 
   3.68034175165644*^9}, {3.680341834012648*^9, 3.680341835815937*^9}, {
   3.6803491879895782`*^9, 3.6803492124141903`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CALCULATE", " ", "EIGENSYSTEM"}], "*)"}]], "Input",
 CellChangeTimes->{{3.680340342637858*^9, 3.68034035362427*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Epsilon]", "=", 
   RowBox[{"10", "^", 
    RowBox[{"-", "10"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"n", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evals", "=", 
   RowBox[{"List", "[", "]"}]}], ";", 
  RowBox[{"evecs", "=", 
   RowBox[{"List", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"En", "=", 
   RowBox[{
    RowBox[{"NestWhileList", "[", 
     RowBox[{"eigenv", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "V0"}], "/", "2"}], ",", "n"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"#1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", 
          RowBox[{"#2", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ">", "\[Epsilon]"}], 
       "&"}], ",", "2", ",", "10"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"While", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Re", "[", "En", "]"}], "<", "0"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"evals", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"evals", ",", "En"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"evecs", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"evecs", ",", 
       RowBox[{"evec", "[", 
        RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], ";", 
    RowBox[{"n", "++"}], ";", 
    RowBox[{"En", "=", 
     RowBox[{
      RowBox[{"NestWhileList", "[", 
       RowBox[{"eigenv", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "V0"}], "/", "2"}], ",", "n"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", 
            RowBox[{"#2", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ">", "\[Epsilon]"}], 
         "&"}], ",", "2", ",", "10"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ";"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.680261150443768*^9, 3.68026122087149*^9}, {
   3.68026136289071*^9, 3.6802613889138737`*^9}, {3.680261512796105*^9, 
   3.680261512875832*^9}, {3.680261599589704*^9, 3.680261634613337*^9}, {
   3.680261736832765*^9, 3.680261758415742*^9}, {3.6802619321630917`*^9, 
   3.680261965162795*^9}, {3.68026200712425*^9, 3.680262007227648*^9}, {
   3.680262152278329*^9, 3.680262163085903*^9}, 3.680262230615035*^9, {
   3.6803416911419973`*^9, 3.680341695053537*^9}, {3.68034196472992*^9, 
   3.680341965025481*^9}, 3.680342061626642*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eval", ",", "evec"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eval", ",", "evec"}], "}"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"eval", ",", "evec"}], "}"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All"}], "]"}], "]"}], ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "<", "0"}], "&"}], ")"}]}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], ";"}], 
   "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"En", "=", 
    RowBox[{"NestWhileList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"SetPrecision", "[", 
        RowBox[{"eigenv", ",", "5"}], "]"}], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "V0"}], ",", "1"}], "}"}]}], ",", "UnsameQ", ",", "2", 
      ",", "100"}], "]"}]}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"eigenv", "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "1"}], "}"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "x"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{
        RowBox[{"-", "V0"}], "/", "2"}], ",", 
       RowBox[{"-", "V0"}], ",", "0"}], "}"}], ",", 
     RowBox[{"WorkingPrecision", "\[Rule]", "2"}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"eigenv", "[", 
         RowBox[{"{", 
          RowBox[{"x", ",", "n"}], "}"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"#", "&"}], "[", "x", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "V0"}], ",", "0"}], "}"}]}], "]"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.679823922297571*^9, 3.679823977196808*^9}, {
   3.679824389570863*^9, 3.679824481572014*^9}, {3.679825241031556*^9, 
   3.6798252637596273`*^9}, {3.680341996610415*^9, 3.6803419984981823`*^9}, 
   3.68034206833178*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"MATCH", " ", "AMPLITUDE"}], " ", "&"}], " ", "PLOT", " ", 
   "RESULTS"}], "*)"}]], "Input",
 CellChangeTimes->{{3.680342070729569*^9, 3.680342087539562*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"wave", "[", 
    RowBox[{"En_", ",", "r_"}], "]"}], ":=", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"k", "[", "En", "]"}]}], " ", "r"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"const", "[", "i_", "]"}], ":=", 
   FractionBox[
    RowBox[{"evecs", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], 
    RowBox[{"wave", "[", 
     RowBox[{
      RowBox[{"evals", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "rmax"}], "]"}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rmaxx", "=", "10."}], ";"}], "\n", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"rlist", ",", 
          RowBox[{
          "evecs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         "}"}], "]"}], ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"rmax", ",", "rmaxx", ",", "dr"}], "]"}], ",", 
          RowBox[{
           RowBox[{"const", "[", "i", "]"}], " ", 
           RowBox[{"wave", "[", 
            RowBox[{
             RowBox[{"evals", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"rmax", ",", "rmaxx", ",", "dr"}], "]"}]}], "]"}]}]}], 
         "}"}], "]"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "evals", "]"}], ",", "1"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.679286348056387*^9, 3.67928637503428*^9}, 
   3.679289773148593*^9, {3.6792902199942904`*^9, 3.6792902689865913`*^9}, {
   3.679290326372958*^9, 3.67929032983473*^9}, {3.679290436757708*^9, 
   3.67929044687678*^9}, {3.679290489640691*^9, 3.679290493254692*^9}, 
   3.679290778399271*^9, 3.679634028673582*^9, {3.679810356011629*^9, 
   3.67981035736366*^9}, {3.679824791944932*^9, 3.679824794368762*^9}, 
   3.6798251662687387`*^9, {3.680342007045088*^9, 3.680342027770771*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`i$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`i$$], 1, 2, 1}}, Typeset`size$$ = {
    360., {109., 113.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`i$14290$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`i$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`i$$, $CellContext`i$14290$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ListLinePlot[{
         Transpose[{$CellContext`rlist, 
           Part[$CellContext`evecs, $CellContext`i$$]}], 
         Transpose[{
           
           Range[$CellContext`rmax, $CellContext`rmaxx, $CellContext`dr], \
$CellContext`const[$CellContext`i$$] $CellContext`wave[
             Part[$CellContext`evals, $CellContext`i$$], 
             
             Range[$CellContext`rmax, $CellContext`rmaxx, \
$CellContext`dr]]}]}, PlotRange -> All], 
      "Specifications" :> {{$CellContext`i$$, 1, 2, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{407., {163., 170.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.680342002504376*^9, 3.680342029662977*^9}, 
   3.680342144016448*^9}]
}, Open  ]]
},
WindowSize->{827, 984},
WindowMargins->{{-2, Automatic}, {-3, Automatic}},
CellContext->Notebook,
FrontEndVersion->"10.3 for Linux x86 (64-bit) (December 10, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 156, 3, 32, "Input"],
Cell[CellGroupData[{
Cell[739, 27, 2714, 61, 276, "Input"],
Cell[3456, 90, 7203, 125, 227, "Output"]
}, Open  ]],
Cell[10674, 218, 4453, 118, 411, "Input"],
Cell[15130, 338, 157, 3, 32, "Input"],
Cell[15290, 343, 2680, 75, 231, "Input"],
Cell[17973, 420, 2352, 72, 121, "Input"],
Cell[20328, 494, 224, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[20577, 504, 2208, 60, 226, "Input"],
Cell[22788, 566, 2033, 43, 350, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
