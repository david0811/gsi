(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     28779,        691]
NotebookOptionsPosition[     28086,        664]
NotebookOutlinePosition[     28447,        680]
CellTagsIndexPosition[     28404,        677]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"DEFINE", " ", "PARAMETERS"}], "*)"}]], "Input",
 CellChangeTimes->{{3.680340241887388*^9, 3.6803402464623203`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["m", "N"], "=", "940"}], ";", 
  RowBox[{"\[HBar]c", "=", "197.327"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"V0", "=", "55"}], ";", 
  RowBox[{"R", "=", "2"}], ";", 
  RowBox[{"a", "=", "0.05"}], ";", 
  RowBox[{"\[Mu]", "=", 
   RowBox[{
    FractionBox["8", "9"], " ", 
    SubscriptBox["m", "N"]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rmax", "=", "5"}], ";", 
  RowBox[{"dr", "=", "0.01"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rlist", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "rmax", ",", "dr"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"len", "=", 
   RowBox[{"Length", "[", "rlist", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "[", "r_", "]"}], ":=", 
   FractionBox[
    RowBox[{"-", "V0"}], 
    RowBox[{"1", "+", 
     RowBox[{"Exp", "[", 
      FractionBox[
       RowBox[{"r", "-", "R"}], "a"], "]"}]}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Vmat", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"V", "[", "rlist", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"V", "[", "rlist", "]"}], ",", 
   RowBox[{"DataRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "rmax"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.679286728059107*^9, 3.679286751534897*^9}, {
   3.679286798295683*^9, 3.679286809263542*^9}, {3.679287253510089*^9, 
   3.679287322870791*^9}, 3.679289429930531*^9, {3.679289796355823*^9, 
   3.679289797938469*^9}, {3.679291047782339*^9, 3.679291048165627*^9}, {
   3.679291140911874*^9, 3.679291141375329*^9}, {3.6793008229741793`*^9, 
   3.679300823061451*^9}, {3.679301164043964*^9, 3.679301164138753*^9}, 
   3.679301319405847*^9, {3.679301744500462*^9, 3.67930174459568*^9}, {
   3.6793070233533278`*^9, 3.679307024200685*^9}, {3.6793071120422153`*^9, 
   3.679307112865924*^9}, {3.6793080233437357`*^9, 3.679308046871706*^9}, {
   3.679634080442708*^9, 3.6796340987636414`*^9}, {3.679634333800329*^9, 
   3.6796343349092484`*^9}, {3.679639176058004*^9, 3.679639188049914*^9}, {
   3.679807334723302*^9, 3.6798073352989483`*^9}, {3.679810418572747*^9, 
   3.6798104194925003`*^9}, 3.679817313239819*^9, {3.67982481522514*^9, 
   3.679824826096957*^9}, 3.679824944379553*^9, {3.679825144782433*^9, 
   3.679825146037923*^9}, {3.6798251853752337`*^9, 3.679825198374642*^9}, {
   3.6798261250607224`*^9, 3.679826125748369*^9}, {3.679826734942071*^9, 
   3.6798267363656807`*^9}, 3.679826793054708*^9, {3.679827280758219*^9, 
   3.679827316430401*^9}, {3.6798274637769814`*^9, 3.679827467464611*^9}, {
   3.679827661452016*^9, 3.679827662939715*^9}, {3.680260876979437*^9, 
   3.680260889931306*^9}, {3.6803421387261133`*^9, 3.680342138836822*^9}, {
   3.680424370553364*^9, 3.680424372433146*^9}, {3.680429646907448*^9, 
   3.680429647178794*^9}, {3.68043688732878*^9, 3.68043689805645*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011111111111111112`],
      AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxd13lcjPsXB/D2ZZpqFmvd7GviJ8m15XsS2mSpq9uGrCUidEO2ouzkkiyl
JHITIQk9M8+0oCJEqO4N7Un73tQ0/TLfbzPD/ON1ND3zfM/7fM48jVy7zX6D
koKCQpuigsKPf396Bdim7h2QYFniH4R+rkOl9ZNhwTXLn0T+8vMb0vrK5R+v
uF/enyCta5f/+J8Hv/x+krRm5Mf4mDEe/3K9p9J6gltIetsE3i/Xp6X1jb7f
zo9J/eXz0qS1ieSV8cvnP5PWGW0/PuE5Evf2vQ7230+mtLaXfGCWtMb3ly2t
S/1/XPCltMb3m4N6SC25PZ/X0hrf/xtpjSFyUTep8XlktVXJjw94h4Skxud7
hzpIfTb9xwHeo3ZS4/PmoWZSS46Tn4eaSI3P/wHVkHr4j9sZ9hF9IzXux0dU
RmqPjT9en1DRT/3JR3mk/nG1AQn56NVP/SpAAlK3SxpSgO791L9CFEnqeZIL
/ouO/dTPf9FWUgf9uL3g/5DdT/0tQuNInSN5FaF2sXy/PyOK1JLjDviCdorl
+/8F6ZNacjm3r+hej7xHMTLqkT9PMTopkvcpRpnd8ucrRgVd8l4lKEkof94S
tKRT3q8EhbfLn78UHW2V9yxFPU24xpcrRSX18r5laEgNriV8wWVod6W8dxnK
Lcb1RMkBy9G3Qnn/crTnHa5fS/pXjiZlys9DBQpLwfV2ST8r0Mx4+fmoQDsu
4XqgpL+V6Eig/LxUouAN8v2uRMss5OenCp0YKt//KhRUKZabpyo07R+xnMc3
xHUTy3l8Q3q9PXIe39Dp0z1yHt9QoVKPnEc12u4skvOoRkdPdMt5VKM3p7vk
PL6jkc5COY/vSL+4Q24+v6Nwbrukni7xqEETS1rk5rUG/W9ak6T+JPGoQfo1
dXLzW4vmf6+W1JLL+deiALUKuXmuReHaXyW1pH3D6pBper7cfNcht8I3klpy
e+l16GhHhty816Nvd5IltYRjYz1q9ImV86hHeRHn5DwaUP56fzmPBmSU6ybn
0YBKE2bKeTSirNNMuflqRP63PollPo1oyvtQsWzeGtGRTQvEMq9G5GZS2iOb
v0b0zzyvHplfI2pLyRfJ5rEJtb4YI5J5NiHmdJtu2Xw2ofNzUZfMtwndnijs
lM1rE5pc4dUh825CaGdQm2x+mxFjybQWmX8z+v2qW6NsnptROVTWyuahGe2M
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
      "]]}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0, 5.}, {-55., 0}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.02]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.6790525019311647`*^9, 3.679052566523169*^9, 3.679196433941718*^9, {
   3.679197277655931*^9, 3.679197294275297*^9}, 3.679203964377475*^9, {
   3.679211502047686*^9, 3.679211535666667*^9}, 3.679211579918518*^9, 
   3.6792116311039762`*^9, 3.67921462355632*^9, 3.6792214221859913`*^9, {
   3.679283487206999*^9, 3.6792835073757553`*^9}, 3.6792846970975523`*^9, 
   3.6792868319626226`*^9, 3.679287023698317*^9, 3.6792873635378437`*^9, 
   3.679287540947575*^9, 3.679287851949174*^9, 3.6792894968350487`*^9, 
   3.679289801327577*^9, 3.67928988339225*^9, {3.679290586852947*^9, 
   3.6792906106198874`*^9}, 3.679291052837352*^9, 3.679291144824926*^9, 
   3.679300829791338*^9, 3.679301167845834*^9, 3.679301321689472*^9, 
   3.679301749581284*^9, {3.679301879491131*^9, 3.6793019059515667`*^9}, 
   3.679307028443761*^9, 3.679307118178897*^9, 3.679307330661931*^9, {
   3.679308027838118*^9, 3.6793080494175997`*^9}, 3.6793094652195168`*^9, 
   3.679312432920207*^9, 3.6793125177770147`*^9, 3.679628067813961*^9, {
   3.679634085969236*^9, 3.679634100282443*^9}, 3.679634336318362*^9, 
   3.679636276044846*^9, 3.679636365377068*^9, 3.679637324382835*^9, {
   3.679639179099791*^9, 3.6796391886563473`*^9}, 3.6796392420372267`*^9, 
   3.679639953216379*^9, 3.679645643238593*^9, 3.679655354505178*^9, 
   3.679657001419363*^9, 3.6798073366123333`*^9, 3.679810113849227*^9, 
   3.679810420396698*^9, 3.679817173602425*^9, 3.67981722445964*^9, 
   3.67981731396034*^9, {3.6798248163876333`*^9, 3.679824826451214*^9}, 
   3.679824944708712*^9, 3.679825085115292*^9, 3.679825146676875*^9, {
   3.6798251878256817`*^9, 3.679825198640245*^9}, 3.679826126089068*^9, 
   3.679826737332171*^9, 3.6798267970030813`*^9, 3.679826897804422*^9, {
   3.6798272817675133`*^9, 3.679827317385491*^9}, 3.679827467911983*^9, 
   3.67982766331116*^9, 3.679831481957348*^9, 3.6802608919077187`*^9, 
   3.680339913758307*^9, 3.680342141076088*^9, 3.680406714588352*^9, 
   3.680424543642042*^9, {3.6804296478611794`*^9, 3.680429650884943*^9}, 
   3.6804335447598333`*^9, {3.6804368985596533`*^9, 3.680436918398417*^9}, 
   3.6804374933396072`*^9, 3.6804379081724577`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"CALCULATE", " ", "HAMILTONIAN", " ", "MATRIX"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"one", "[", 
      RowBox[{"n_", ",", "d_"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{
       RowBox[{"1", "+", 
        RowBox[{"0", 
         RowBox[{"Range", "[", 
          RowBox[{"n", "-", 
           RowBox[{"Abs", "[", "d", "]"}]}], "]"}]}]}], ",", "d"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"H0", "=", 
     RowBox[{"Vmat", "+", 
      RowBox[{
       FractionBox[
        RowBox[{"-", 
         SuperscriptBox["\[HBar]c", "2"]}], 
        RowBox[{"2", " ", "\[Mu]"}]], " ", 
       FractionBox["1", 
        SuperscriptBox["dr", "2"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"one", "[", 
          RowBox[{"len", ",", 
           RowBox[{"-", "1"}]}], "]"}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"one", "[", 
           RowBox[{"len", ",", "0"}], "]"}]}], "+", 
         RowBox[{"one", "[", 
          RowBox[{"len", ",", "1"}], "]"}]}], ")"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"k", "[", "En_", "]"}], ":=", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", "\[Mu]", " ", "En"}], 
        SuperscriptBox["\[HBar]c", "2"]]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"B", "[", "En_", "]"}], ":=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"k", "[", "En", "]"}]}], " ", "rmax"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Hnew", "[", "En_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"H", "=", "H0"}], ";", 
      RowBox[{
       RowBox[{"H", "[", 
        RowBox[{"[", 
         RowBox[{"len", ",", "len"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"Vmat", "[", 
         RowBox[{"[", 
          RowBox[{"len", ",", "len"}], "]"}], "]"}], "+", 
        RowBox[{
         FractionBox[
          RowBox[{"-", 
           SuperscriptBox["\[HBar]c", "2"]}], 
          RowBox[{"2", " ", "\[Mu]"}]], " ", 
         FractionBox["1", 
          SuperscriptBox["dr", "2"]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dr", " ", 
            FractionBox[
             RowBox[{
              StyleBox["B",
               FontWeight->"Plain"], "[", "En", "]"}], "rmax"]}], "-", "1"}], 
          ")"}]}]}]}], ";", "H"}], ")"}]}], "\n", 
   RowBox[{
    RowBox[{"eigenv", "[", 
     RowBox[{"{", 
      RowBox[{"En_", ",", "i_"}], "}"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eval", ",", "evec"}], "}"}], "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Eigensystem", "[", 
            RowBox[{"Hnew", "[", "En", "]"}], "]"}], "]"}], ",", "First"}], 
         "]"}]}]}], ";", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eval", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "i"}], "}"}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.6790391017469873`*^9, {3.6790392440208473`*^9, 3.679039313462309*^9}, {
   3.679039353022828*^9, 3.6790393624544992`*^9}, {3.679039514753272*^9, 
   3.67903951659298*^9}, {3.679039723124398*^9, 3.67903975046845*^9}, {
   3.67921405591895*^9, 3.6792140664227943`*^9}, {3.6792146406725883`*^9, 
   3.679214647440013*^9}, {3.679286881961419*^9, 3.6792868921054163`*^9}, {
   3.679287380328823*^9, 3.6792873838310957`*^9}, {3.6792894539741707`*^9, 
   3.679289459285552*^9}, {3.6793094743259706`*^9, 3.6793094836301937`*^9}, {
   3.67963411316535*^9, 3.679634126807611*^9}, {3.679636756756248*^9, 
   3.6796367614119797`*^9}, {3.679637096065898*^9, 3.679637103161354*^9}, {
   3.6796372385233088`*^9, 3.67963724314743*^9}, {3.679807339891375*^9, 
   3.6798073552994413`*^9}, {3.679810170937397*^9, 3.679810174089325*^9}, {
   3.679817648629161*^9, 3.679817660253252*^9}, {3.680261003798294*^9, 
   3.680261056214637*^9}, {3.680340250552248*^9, 3.680340328885063*^9}, 
   3.6803410314839163`*^9, {3.680341148773532*^9, 3.680341150493453*^9}, {
   3.680341191086194*^9, 3.680341194542293*^9}, {3.680341322040676*^9, 
   3.680341348936768*^9}, {3.6803415482924843`*^9, 3.680341550372074*^9}, {
   3.6803415928052187`*^9, 3.680341594916544*^9}, {3.6803417095588493`*^9, 
   3.68034175165644*^9}, {3.680341834012648*^9, 3.680341835815937*^9}, {
   3.6803491879895782`*^9, 3.6803492124141903`*^9}, {3.680424073412672*^9, 
   3.680424119358172*^9}, {3.680424261791725*^9, 3.680424281839983*^9}, {
   3.680424334257407*^9, 3.680424345801024*^9}, {3.6804299042238207`*^9, 
   3.680429910583832*^9}, {3.680430049489995*^9, 3.680430055417577*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CALCULATE", " ", "EIGENSYSTEM"}], "*)"}]], "Input",
 CellChangeTimes->{{3.680340342637858*^9, 3.68034035362427*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Epsilon]", "=", 
   RowBox[{"10", "^", 
    RowBox[{"-", "10"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"n", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evals", "=", 
   RowBox[{"List", "[", "]"}]}], ";", 
  RowBox[{"evecs", "=", 
   RowBox[{"List", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"En", "=", 
   RowBox[{
    RowBox[{"NestWhileList", "[", 
     RowBox[{"eigenv", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "V0"}], "/", "2"}], ",", "n"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"#1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", 
          RowBox[{"#2", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ">", "\[Epsilon]"}], 
       "&"}], ",", "2", ",", "10"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"While", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Re", "[", "En", "]"}], "<", "0"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"evals", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"evals", ",", "En"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"evecs", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"evecs", ",", 
       RowBox[{"evec", "[", 
        RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], ";", 
    RowBox[{"n", "++"}], ";", 
    RowBox[{"En", "=", 
     RowBox[{
      RowBox[{"NestWhileList", "[", 
       RowBox[{"eigenv", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "V0"}], "/", "2"}], ",", "n"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", 
            RowBox[{"#2", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ">", "\[Epsilon]"}], 
         "&"}], ",", "2", ",", "10"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ";"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.680261150443768*^9, 3.68026122087149*^9}, {
   3.68026136289071*^9, 3.6802613889138737`*^9}, {3.680261512796105*^9, 
   3.680261512875832*^9}, {3.680261599589704*^9, 3.680261634613337*^9}, {
   3.680261736832765*^9, 3.680261758415742*^9}, {3.6802619321630917`*^9, 
   3.680261965162795*^9}, {3.68026200712425*^9, 3.680262007227648*^9}, {
   3.680262152278329*^9, 3.680262163085903*^9}, 3.680262230615035*^9, {
   3.6803416911419973`*^9, 3.680341695053537*^9}, {3.68034196472992*^9, 
   3.680341965025481*^9}, 3.680342061626642*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eval", ",", "evec"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eval", ",", "evec"}], "}"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"eval", ",", "evec"}], "}"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All"}], "]"}], "]"}], ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "<", "0"}], "&"}], ")"}]}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], ";"}], 
   "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"En", "=", 
    RowBox[{"NestWhileList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"SetPrecision", "[", 
        RowBox[{"eigenv", ",", "5"}], "]"}], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "V0"}], ",", "1"}], "}"}]}], ",", "UnsameQ", ",", "2", 
      ",", "100"}], "]"}]}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"eigenv", "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "1"}], "}"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "x"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{
        RowBox[{"-", "V0"}], "/", "2"}], ",", 
       RowBox[{"-", "V0"}], ",", "0"}], "}"}], ",", 
     RowBox[{"WorkingPrecision", "\[Rule]", "2"}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"eigenv", "[", 
         RowBox[{"{", 
          RowBox[{"x", ",", "n"}], "}"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"#", "&"}], "[", "x", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "V0"}], ",", "0"}], "}"}]}], "]"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.679823922297571*^9, 3.679823977196808*^9}, {
   3.679824389570863*^9, 3.679824481572014*^9}, {3.679825241031556*^9, 
   3.6798252637596273`*^9}, {3.680341996610415*^9, 3.6803419984981823`*^9}, 
   3.68034206833178*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"MATCH", " ", "AMPLITUDE"}], " ", "&"}], " ", "PLOT", " ", 
   "RESULTS"}], "*)"}]], "Input",
 CellChangeTimes->{{3.680342070729569*^9, 3.680342087539562*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"wave", "[", 
    RowBox[{"En_", ",", "r_"}], "]"}], ":=", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"k", "[", "En", "]"}]}], " ", "r"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"const", "[", "i_", "]"}], ":=", 
   FractionBox[
    RowBox[{"evecs", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], 
    RowBox[{"wave", "[", 
     RowBox[{
      RowBox[{"evals", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "rmax"}], "]"}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rmaxx", "=", "10."}], ";"}], "\n", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"rlist", ",", 
          RowBox[{
          "evecs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         "}"}], "]"}], ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"rmax", ",", "rmaxx", ",", "dr"}], "]"}], ",", 
          RowBox[{
           RowBox[{"const", "[", "i", "]"}], " ", 
           RowBox[{"wave", "[", 
            RowBox[{
             RowBox[{"evals", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"rmax", ",", "rmaxx", ",", "dr"}], "]"}]}], "]"}]}]}], 
         "}"}], "]"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "evals", "]"}], ",", "1"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.679286348056387*^9, 3.67928637503428*^9}, 
   3.679289773148593*^9, {3.6792902199942904`*^9, 3.6792902689865913`*^9}, {
   3.679290326372958*^9, 3.67929032983473*^9}, {3.679290436757708*^9, 
   3.67929044687678*^9}, {3.679290489640691*^9, 3.679290493254692*^9}, 
   3.679290778399271*^9, 3.679634028673582*^9, {3.679810356011629*^9, 
   3.67981035736366*^9}, {3.679824791944932*^9, 3.679824794368762*^9}, 
   3.6798251662687387`*^9, {3.680342007045088*^9, 3.680342027770771*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`i$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`i$$], 1, 1, 1}}, Typeset`size$$ = {
    360., {109., 113.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`i$468$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`i$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`i$$, $CellContext`i$468$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ListLinePlot[{
         Transpose[{$CellContext`rlist, 
           Part[$CellContext`evecs, $CellContext`i$$]}], 
         Transpose[{
           
           Range[$CellContext`rmax, $CellContext`rmaxx, $CellContext`dr], \
$CellContext`const[$CellContext`i$$] $CellContext`wave[
             Part[$CellContext`evals, $CellContext`i$$], 
             
             Range[$CellContext`rmax, $CellContext`rmaxx, \
$CellContext`dr]]}]}, PlotRange -> All], 
      "Specifications" :> {{$CellContext`i$$, 1, 1, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{407., {163., 170.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.680406920858172*^9, 3.680424319554172*^9, 
  3.680424546870346*^9, 3.680429654358959*^9, 3.6804335481003017`*^9, 
  3.6804369355426073`*^9, 3.6804379173623657`*^9}]
}, Open  ]]
},
WindowSize->{827, 984},
WindowMargins->{{Automatic, -9}, {Automatic, -2}},
CellContext->Notebook,
FrontEndVersion->"10.3 for Linux x86 (64-bit) (December 10, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 156, 3, 32, "Input"],
Cell[CellGroupData[{
Cell[739, 27, 2858, 63, 276, "Input"],
Cell[3600, 92, 9867, 168, 231, "Output"]
}, Open  ]],
Cell[13482, 263, 4804, 124, 411, "Input"],
Cell[18289, 389, 157, 3, 32, "Input"],
Cell[18449, 394, 2680, 75, 231, "Input"],
Cell[21132, 471, 2352, 72, 121, "Input"],
Cell[23487, 545, 224, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[23736, 555, 2208, 60, 226, "Input"],
Cell[25947, 617, 2123, 44, 350, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
